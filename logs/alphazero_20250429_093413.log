2025-04-29 09:34:13,747 - __main__ - INFO - Initializing AlphaZero trainer
2025-04-29 09:34:13,747 - __main__ - INFO - Debug mode: True
2025-04-29 09:34:13,763 - __main__ - INFO - ==================================================
2025-04-29 09:34:13,764 - __main__ - INFO - DETAILED ENVIRONMENT DIMENSIONS ANALYSIS
2025-04-29 09:34:13,764 - __main__ - INFO - ==================================================
2025-04-29 09:34:13,765 - __main__ - INFO - Card feature dimension: 8
2025-04-29 09:34:13,765 - __main__ - INFO - Primary cards shape: (90, 8)
2025-04-29 09:34:13,765 - __main__ - INFO - 
--- State Dimension Breakdown ---
2025-04-29 09:34:13,765 - __main__ - INFO - 1. Card state: 4 levels × 3 cards × 8 features = 96
2025-04-29 09:34:13,766 - __main__ - INFO - 2. Gems: 6 types = 6
2025-04-29 09:34:13,766 - __main__ - INFO - 3. Player state: 6 (gems) + 5 (other) + 8 × 3 cards = 35
2025-04-29 09:34:13,767 - __main__ - INFO - 4. Noble tiles: 5 nobles × 5 features = 25
2025-04-29 09:34:13,767 - __main__ - INFO - 
Total state dimension: 96 + 6 + 35 + 25 = 162
2025-04-29 09:34:13,767 - __main__ - INFO - Action dimension: 88
2025-04-29 09:34:13,767 - __main__ - INFO - 
--- State Dimension Formula ---
2025-04-29 09:34:13,768 - __main__ - INFO - state_dim = (4 × 3 × 8) + 6 + (6 + 5 + 8 × 3) + (5 × 5)
2025-04-29 09:34:13,768 - __main__ - INFO - state_dim = 96 + 6 + 11 + 24 + 25
2025-04-29 09:34:13,768 - __main__ - INFO - state_dim = 120 + 42 = 162
2025-04-29 09:34:14,191 - __main__ - INFO - Using device: cuda
2025-04-29 09:34:15,961 - __main__ - INFO - Environment initialized with state_dim=162, action_dim=88
2025-04-29 09:34:15,961 - __main__ - INFO - Training parameters: lr=0.001, weight_decay=0.0001, batch_size=2048, replay_size=10000, num_simulations=100
2025-04-29 09:34:15,962 - __main__ - INFO - ==================================================
2025-04-29 09:34:15,963 - __main__ - WARNING - Model file models/alphazero_final.pth not found. Starting with a new model.
2025-04-29 09:34:15,963 - __main__ - INFO - Starting AlphaZero training from iteration 1 for 20 iterations
2025-04-29 09:34:15,964 - __main__ - INFO - Starting iteration 1/20
2025-04-29 09:34:15,964 - __main__ - INFO - Starting self-play phase
2025-04-29 09:34:15,964 - __main__ - INFO - Current curriculum stage: {'min_score': 5}
2025-04-29 09:34:15,975 - __main__ - INFO - Starting game 1/20
2025-04-29 09:34:17,988 - __main__ - DEBUG - Game 1, Step 1: Player 0 chose action 49
2025-04-29 09:34:18,574 - __main__ - DEBUG - Game 1, Step 2: Player 1 chose action 15
2025-04-29 09:34:19,120 - __main__ - DEBUG - Game 1, Step 3: Player 2 chose action 1
2025-04-29 09:34:19,610 - __main__ - DEBUG - Game 1, Step 4: Player 3 chose action 15
2025-04-29 09:34:20,087 - __main__ - DEBUG - Game 1, Step 5: Player 0 chose action 21
2025-04-29 09:34:20,708 - __main__ - DEBUG - Game 1, Step 6: Player 1 chose action 8
2025-04-29 09:34:21,244 - __main__ - DEBUG - Game 1, Step 7: Player 2 chose action 16
2025-04-29 09:34:21,718 - __main__ - DEBUG - Game 1, Step 8: Player 3 chose action 50
2025-04-29 09:34:22,221 - __main__ - DEBUG - Game 1, Step 9: Player 0 chose action 7
2025-04-29 09:34:22,757 - __main__ - DEBUG - Game 1, Step 10: Player 1 chose action 6
2025-04-29 09:34:23,311 - __main__ - DEBUG - Game 1, Step 11: Player 2 chose action 11
